<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Checkout - Complete your order at Loom Saga. Secure checkout for luxury handcrafted sarees." />
    <meta name="author" content="Loom Saga" />

    <title>Checkout | Loom Saga - Weaving Indian Culture</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500&family=Montserrat:wght@300;400;500;600&family=Pinyon+Script&display=swap" rel="stylesheet" />

    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <!-- ==================== HEADER ==================== -->
    <header class="header header-dark" id="header">
      <div class="header-container">
        <div class="header-top">
          <button class="hamburger" id="hamburger" aria-label="Toggle Menu" aria-expanded="false">
            <span></span>
            <span></span>
            <span></span>
          </button>

          <p class="tagline">Weaving Indian Culture</p>

          <a href="index.html" class="logo" aria-label="Loom Saga Home">
            <img src="assets/images/logo.png" alt="Loom Saga Logo" class="logo-image" />
            <span class="logo-text">Loom Saga</span>
          </a>

          <div class="header-icons">
            <button class="icon-btn" id="searchBtn" aria-label="Search">
              <img src="assets/icons/search.png" alt="Search" width="20" height="20" />
            </button>
            <a href="wishlist.html" class="icon-btn" aria-label="Wishlist">
              <img src="assets/icons/heart.png" alt="Wishlist" width="20" height="20" />
              <span class="icon-badge" id="wishlistCount">0</span>
            </a>
            <a href="login.html" class="icon-btn" id="accountBtn" aria-label="Account">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
            </a>
            <a href="cart.html" class="icon-btn" aria-label="Shopping Cart">
              <img src="assets/icons/cart.png" alt="Cart" width="20" height="20" />
              <span class="icon-badge" id="cartCount">0</span>
            </a>
          </div>
        </div>
      </div>
    </header>

    <!-- Mobile Navigation Overlay -->
    <div class="nav-overlay" id="navOverlay"></div>

    <!-- ==================== CHECKOUT PAGE ==================== -->
    <main class="checkout-page">
      <div class="container">
        <!-- Checkout Header -->
        <div class="checkout-header">
          <h1 class="checkout-title">CHECKOUT</h1>
          <a href="cart.html" class="back-to-cart">‚Üê Back to Cart</a>
        </div>

        <!-- Progress Steps -->
        <div class="checkout-progress">
          <div class="progress-step active" data-step="1">
            <span class="step-number">1</span>
            <span class="step-label">Shipping</span>
          </div>
          <div class="progress-line"></div>
          <div class="progress-step" data-step="2">
            <span class="step-number">2</span>
            <span class="step-label">Payment</span>
          </div>
          <div class="progress-line"></div>
          <div class="progress-step" data-step="3">
            <span class="step-number">3</span>
            <span class="step-label">Confirmation</span>
          </div>
        </div>

        <!-- Checkout Content -->
        <div class="checkout-content">
          <!-- Left Column - Forms -->
          <div class="checkout-forms">
            
            <!-- Shipping Address Section -->
            <section class="checkout-section" id="shippingSection">
              <h2 class="section-title">Shipping Address</h2>
              <form class="checkout-form" id="shippingForm">
                <div class="form-row">
                  <div class="form-group">
                    <label for="fullName">Full Name *</label>
                    <input type="text" id="fullName" name="fullName" required minlength="2" placeholder="Enter your full name">
                  </div>
                  <div class="form-group">
                    <label for="phone">Phone Number *</label>
                    <input type="tel" id="phone" name="phone" required pattern="[0-9]{10}" placeholder="10-digit mobile number">
                  </div>
                </div>

                <div class="form-group">
                  <label for="email">Email Address *</label>
                  <input type="email" id="email" name="email" required placeholder="your@email.com">
                </div>

                <div class="form-group">
                  <label for="address1">Address Line 1 *</label>
                  <input type="text" id="address1" name="address1" required minlength="5" placeholder="House/Flat No., Building Name">
                </div>

                <div class="form-group">
                  <label for="address2">Address Line 2</label>
                  <input type="text" id="address2" name="address2" placeholder="Street, Landmark (Optional)">
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="pincode">Pincode *</label>
                    <input type="text" id="pincode" name="pincode" required pattern="[0-9]{6}" maxlength="6" placeholder="6-digit pincode">
                    <span class="pincode-status" id="pincodeStatus"></span>
                  </div>
                  <div class="form-group">
                    <label for="city">City *</label>
                    <input type="text" id="city" name="city" required minlength="2" placeholder="City">
                  </div>
                </div>

                <div class="form-group">
                  <label for="state">State *</label>
                  <select id="state" name="state" required>
                    <option value="">Select State</option>
                    <optgroup label="States">
                      <option value="Andhra Pradesh">Andhra Pradesh</option>
                      <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                      <option value="Assam">Assam</option>
                      <option value="Bihar">Bihar</option>
                      <option value="Chhattisgarh">Chhattisgarh</option>
                      <option value="Goa">Goa</option>
                      <option value="Gujarat">Gujarat</option>
                      <option value="Haryana">Haryana</option>
                      <option value="Himachal Pradesh">Himachal Pradesh</option>
                      <option value="Jharkhand">Jharkhand</option>
                      <option value="Karnataka">Karnataka</option>
                      <option value="Kerala">Kerala</option>
                      <option value="Madhya Pradesh">Madhya Pradesh</option>
                      <option value="Maharashtra">Maharashtra</option>
                      <option value="Manipur">Manipur</option>
                      <option value="Meghalaya">Meghalaya</option>
                      <option value="Mizoram">Mizoram</option>
                      <option value="Nagaland">Nagaland</option>
                      <option value="Odisha">Odisha</option>
                      <option value="Punjab">Punjab</option>
                      <option value="Rajasthan">Rajasthan</option>
                      <option value="Sikkim">Sikkim</option>
                      <option value="Tamil Nadu">Tamil Nadu</option>
                      <option value="Telangana">Telangana</option>
                      <option value="Tripura">Tripura</option>
                      <option value="Uttar Pradesh">Uttar Pradesh</option>
                      <option value="Uttarakhand">Uttarakhand</option>
                      <option value="West Bengal">West Bengal</option>
                    </optgroup>
                    <optgroup label="Union Territories">
                      <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                      <option value="Chandigarh">Chandigarh</option>
                      <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                      <option value="Delhi">Delhi</option>
                      <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                      <option value="Ladakh">Ladakh</option>
                      <option value="Lakshadweep">Lakshadweep</option>
                      <option value="Puducherry">Puducherry</option>
                    </optgroup>
                  </select>
                </div>
              </form>
            </section>

            <!-- Billing Address Section -->
            <section class="checkout-section" id="billingSection">
              <h2 class="section-title">Billing Address</h2>
              <div class="billing-same-as-shipping">
                <input type="checkbox" id="sameAsShipping" name="sameAsShipping" checked>
                <label for="sameAsShipping">Same as shipping address</label>
              </div>
              <div class="billing-form-container" id="billingFormContainer" style="display: none;">
                <!-- Billing form fields will be similar to shipping -->
                <p class="billing-note">Billing address form appears here when unchecked</p>
              </div>
            </section>

            <!-- Payment Section -->
            <section class="checkout-section" id="paymentSection">
              <h2 class="section-title">Payment Method</h2>
              <div class="payment-options">
                <label class="payment-option selected">
                  <input type="radio" name="paymentMethod" value="cod" checked>
                  <span class="payment-icon">üíµ</span>
                  <span class="payment-details">
                    <span class="payment-name">Cash on Delivery</span>
                    <span class="payment-desc">Pay when you receive your order</span>
                  </span>
                </label>
                <label class="payment-option disabled">
                  <input type="radio" name="paymentMethod" value="online" disabled>
                  <span class="payment-icon">üí≥</span>
                  <span class="payment-details">
                    <span class="payment-name">Online Payment</span>
                    <span class="payment-desc">Coming Soon - Razorpay</span>
                  </span>
                  <span class="coming-soon-badge">Coming Soon</span>
                </label>
              </div>
            </section>

            <!-- Delivery Info -->
            <section class="checkout-section delivery-info">
              <div class="delivery-estimate">
                <span class="delivery-icon">üöö</span>
                <span class="delivery-text">
                  <strong>Estimated Delivery:</strong> 7-10 business days
                </span>
              </div>
            </section>

          </div>

          <!-- Right Column - Order Summary -->
          <aside class="order-summary">
            <h2 class="summary-title">Order Summary</h2>
            
            <!-- Order Items -->
            <div class="summary-items" id="summaryItems">
              <!-- Items will be rendered by JavaScript -->
            </div>

            <!-- Order Totals -->
            <div class="summary-totals">
              <div class="summary-row">
                <span>Subtotal</span>
                <span id="subtotal">‚Çπ0.00</span>
              </div>
              <div class="summary-row">
                <span>Shipping</span>
                <span id="shipping">FREE</span>
              </div>
              <div class="summary-row">
                <span>Tax (GST 5%)</span>
                <span id="tax">‚Çπ0.00</span>
              </div>
              <div class="summary-row total">
                <span>Total</span>
                <span id="orderTotal">‚Çπ0.00</span>
              </div>
            </div>

            <!-- Place Order Button -->
            <button class="place-order-btn" id="placeOrderBtn">
              PLACE ORDER
            </button>

            <!-- Secure Checkout Note -->
            <p class="secure-note">
              üîí Your information is secure and encrypted
            </p>
          </aside>
        </div>
      </div>
    </main>

    <!-- ==================== FOOTER ==================== -->
    <!-- ==================== FOOTER ==================== -->
    <footer class="footer" id="footer">
      <div class="footer-pattern"></div>
      <div class="footer-content">
        <div class="container">
          <div class="footer-grid">
            <!-- Newsletter Column -->
            <div class="footer-column footer-newsletter">
              <h3 class="footer-heading">NEWSLETTER</h3>
              <p class="footer-text">Subscribe to receive updates, access to exclusive deals, and more.</p>
              <form class="newsletter-form" id="newsletterForm">
                <input 
                  type="email" 
                  placeholder="Email" 
                  class="newsletter-input" 
                  required
                  aria-label="Email address"
                >
                <button type="submit" class="newsletter-btn">Subscribe</button>
              </form>
              
              <h4 class="footer-subheading">Find our store</h4>
              <div class="social-icons">
                <a href="#" class="social-icon" aria-label="Instagram">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <rect x="2" y="2" width="20" height="20" rx="5" ry="5"/>
                    <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
                    <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/>
                  </svg>
                </a>
                <a href="#" class="social-icon" aria-label="Facebook">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
                  </svg>
                </a>
                <a href="#" class="social-icon" aria-label="WhatsApp">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.9 7.9 0 0 0 13.6 2.326z"/>
                  </svg>
                </a>
                <a href="#" class="social-icon" aria-label="YouTube">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"/>
                    <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/>
                  </svg>
                </a>
              </div>
            </div>

            <!-- The Company Column -->
            <div class="footer-column">
              <h3 class="footer-heading">THE COMPANY</h3>
              <ul class="footer-links">
                <li><a href="#">New Arrivals</a></li>
                <li><a href="collections.html">Collection</a></li>
                <li><a href="silk-sarees.html">Sarees</a></li>
                <li><a href="handloom.html">Crafts</a></li>
                <li><a href="about.html">About Us</a></li>
              </ul>
            </div>

            <!-- Need Help Column -->
            <div class="footer-column">
              <h3 class="footer-heading">NEED HELP</h3>
              <ul class="footer-links">
                <li><a href="contact.html">Contact Us</a></li>
                <li><a href="#">Book an Appointment</a></li>
                <li><a href="#">Shipping</a></li>
                <li><a href="#">FAQ's</a></li>
                <li><a href="#">Track Order</a></li>
              </ul>
            </div>

            <!-- Legal Column -->
            <div class="footer-column">
              <h3 class="footer-heading">LEGAL</h3>
              <ul class="footer-links">
                <li><a href="#">Privacy & Cookies</a></li>
                <li><a href="#">Fees And Payment</a></li>
                <li><a href="#">Term And Condition</a></li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Footer Bottom -->
        <div class="footer-bottom">
          <div class="footer-separator"></div>
          <p class="footer-copyright">¬© 2026, Loom Saga</p>
        </div>
      </div>
    </footer>

    <!-- JavaScript -->
    <script src="js/main.js"></script>

    <!-- Checkout Script -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Get cart items from localStorage
        const cartItems = JSON.parse(localStorage.getItem('loomSaga_cart')) || [];
        
        // If cart is empty, redirect to cart page
        if (cartItems.length === 0) {
          window.location.href = 'cart.html';
          return;
        }

        // Render order summary
        renderOrderSummary(cartItems);

        // Pincode lookup functionality
        const pincodeInput = document.getElementById('pincode');
        const cityInput = document.getElementById('city');
        const stateSelect = document.getElementById('state');
        const pincodeStatus = document.getElementById('pincodeStatus');

        let pincodeTimeout;
        pincodeInput.addEventListener('input', function() {
          const pincode = this.value;
          clearTimeout(pincodeTimeout);
          
          if (pincode.length === 6) {
            pincodeStatus.textContent = 'Looking up...';
            pincodeStatus.className = 'pincode-status loading';
            
            pincodeTimeout = setTimeout(() => {
              fetchPincodeDetails(pincode);
            }, 300);
          } else {
            pincodeStatus.textContent = '';
          }
        });

        // Fetch pincode details from API
        async function fetchPincodeDetails(pincode) {
          try {
            const response = await fetch(`https://api.postalpincode.in/pincode/${pincode}`);
            const data = await response.json();
            
            if (data[0].Status === 'Success' && data[0].PostOffice && data[0].PostOffice.length > 0) {
              const postOffice = data[0].PostOffice[0];
              cityInput.value = postOffice.District;
              stateSelect.value = postOffice.State;
              pincodeStatus.textContent = '‚úì Found';
              pincodeStatus.className = 'pincode-status success';
            } else {
              pincodeStatus.textContent = 'Pincode not found';
              pincodeStatus.className = 'pincode-status error';
            }
          } catch (error) {
            pincodeStatus.textContent = 'Could not verify';
            pincodeStatus.className = 'pincode-status error';
          }
        }

        // Billing address toggle
        const sameAsShippingCheckbox = document.getElementById('sameAsShipping');
        const billingFormContainer = document.getElementById('billingFormContainer');
        
        sameAsShippingCheckbox.addEventListener('change', function() {
          billingFormContainer.style.display = this.checked ? 'none' : 'block';
        });

        // Payment option selection
        const paymentOptions = document.querySelectorAll('.payment-option:not(.disabled)');
        paymentOptions.forEach(option => {
          option.addEventListener('click', function() {
            paymentOptions.forEach(opt => opt.classList.remove('selected'));
            this.classList.add('selected');
            this.querySelector('input').checked = true;
          });
        });

        // Place Order button
        const placeOrderBtn = document.getElementById('placeOrderBtn');
        placeOrderBtn.addEventListener('click', function() {
          const shippingForm = document.getElementById('shippingForm');
          
          if (!shippingForm.checkValidity()) {
            shippingForm.reportValidity();
            return;
          }

          // Collect order data
          const orderData = {
            orderId: generateOrderId(),
            orderDate: new Date().toISOString(),
            items: cartItems,
            shipping: {
              fullName: document.getElementById('fullName').value,
              phone: document.getElementById('phone').value,
              email: document.getElementById('email').value,
              address1: document.getElementById('address1').value,
              address2: document.getElementById('address2').value,
              pincode: document.getElementById('pincode').value,
              city: document.getElementById('city').value,
              state: document.getElementById('state').value
            },
            paymentMethod: document.querySelector('input[name="paymentMethod"]:checked').value,
            subtotal: calculateSubtotal(cartItems),
            tax: calculateTax(cartItems),
            total: calculateTotal(cartItems)
          };

          // Save order to localStorage
          localStorage.setItem('loomSaga_lastOrder', JSON.stringify(orderData));
          
          // Clear cart
          localStorage.setItem('loomSaga_cart', JSON.stringify([]));

          // Redirect to confirmation page
          window.location.href = 'order-confirmation.html';
        });

        // Helper functions
        function renderOrderSummary(items) {
          const summaryItemsContainer = document.getElementById('summaryItems');
          let html = '';

          items.forEach(item => {
            html += `
              <div class="summary-item">
                <div class="item-image">
                  <img src="${item.image}" alt="${item.name}">
                  <span class="item-quantity">${item.quantity}</span>
                </div>
                <div class="item-details">
                  <p class="item-name">${item.name}</p>
                  <p class="item-price">‚Çπ${formatPrice(item.price * item.quantity)}</p>
                </div>
              </div>
            `;
          });

          summaryItemsContainer.innerHTML = html;

          // Update totals
          const subtotal = calculateSubtotal(items);
          const tax = calculateTax(items);
          const total = calculateTotal(items);

          document.getElementById('subtotal').textContent = `‚Çπ${formatPrice(subtotal)}`;
          document.getElementById('tax').textContent = `‚Çπ${formatPrice(tax)}`;
          document.getElementById('orderTotal').textContent = `‚Çπ${formatPrice(total)}`;
        }

        function calculateSubtotal(items) {
          return items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        }

        function calculateTax(items) {
          return Math.round(calculateSubtotal(items) * 0.05); // 5% GST
        }

        function calculateTotal(items) {
          return calculateSubtotal(items) + calculateTax(items);
        }

        function formatPrice(amount) {
          return amount.toLocaleString('en-IN');
        }

        function generateOrderId() {
          const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
          let orderId = 'LS-';
          for (let i = 0; i < 8; i++) {
            orderId += chars.charAt(Math.floor(Math.random() * chars.length));
          }
          return orderId;
        }
      });
    </script>
  </body>
</html>
